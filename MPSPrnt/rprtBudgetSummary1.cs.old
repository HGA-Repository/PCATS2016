using System;
using DataDynamics.ActiveReports;
using DataDynamics.ActiveReports.Document;

namespace RSMPS
{
	public class rprtBudgetSummary1 : ActiveReport
	{
        private int miTotalHours = 0;
        private decimal mdTotalHourDollars = 0;
        private decimal mdTotalExpenses = 0;
        private decimal mdContingency = 0;

        public void SetTitles(string jobNumber, string jobDesc, string revision, string customer, string location)
        {
            lblJobNumber.Text = jobNumber;
            lblProject.Text = jobDesc;
            lblRevision.Text = revision;
            lblLocation.Text = location;
            lblcustomer.Text = customer;
        }

        public int TotalHours
        {
            get { return miTotalHours; }
            set { miTotalHours = value; }
        }

        public decimal TotalHourDollars
        {
            get { return mdTotalHourDollars; }
            set { mdTotalHourDollars = value; }
        }

        public decimal TotalExpenses
        {
            get { return mdTotalExpenses; }
            set { mdTotalExpenses = value; }
        }

        public decimal Contingency
        {
            get { return mdContingency; }
            set { mdContingency = value; }
        }

		public rprtBudgetSummary1()
		{
			InitializeReport();
		}

		private void Detail_Format(object sender, System.EventArgs eArgs)
		{
            rprtBudgetSummaryGeneral rprtGen = new rprtBudgetSummaryGeneral();
            rprtBudgetSummaryEngineering rprtEngr = new rprtBudgetSummaryEngineering();
            rprtBudgetSummaryExpenses rprtExp = new rprtBudgetSummaryExpenses();

            rprtGen.TotalHours = miTotalHours;
            rprtGen.DataSource = this.DataSource;
            rprtGen.DataMember = "Table1";
            subGeneral.Report = rprtGen;

            rprtEngr.TotalHours = miTotalHours;
            rprtEngr.DataSource = this.DataSource;
            rprtEngr.DataMember = "Table2";
            subEngr.Report = rprtEngr;

            txtEngrLoadedDollars.Value = mdTotalHourDollars;
            txtEngrMHrs.Value = miTotalHours;

            if (miTotalHours != 0)
            {
                txtEngrLoadedRate.Value = mdTotalHourDollars / Convert.ToDecimal(miTotalHours);
            }
            else
            {
                txtEngrLoadedRate.Value = 0;
            }

            rprtExp.TotalHours = miTotalHours;
            rprtExp.DataSource = this.DataSource;
            rprtExp.DataMember = "Table3";
            subExpenses.Report = rprtExp;

            txtTotalLoadedDollars.Value = mdTotalHourDollars + mdTotalExpenses;
            txtTotalMHrs.Value = miTotalHours;

            if (miTotalHours != 0)
            {
                txtTotalLoadedRate.Value = (mdTotalHourDollars + mdTotalExpenses) / Convert.ToDecimal(miTotalHours);
            }
            else
            {
                txtTotalLoadedRate.Value = 0;
            }

            txtContengency.Value = mdContingency;

            if ((mdTotalExpenses + mdTotalHourDollars) != 0)
            {
                txtContingencyPerc.Value = (mdContingency / (mdTotalExpenses + mdTotalHourDollars)) * 100.0m;
            }
            else
            {
                txtContingencyPerc.Value = 0;
            }

            txtTotalDollars.Value = mdTotalHourDollars + mdTotalExpenses + mdContingency;
		}

		private void rprtBudgetSummary1_PageStart(object sender, System.EventArgs eArgs)
		{
            Document.Printer.PrinterName = "";
		}

		#region ActiveReports Designer generated code
		private DataDynamics.ActiveReports.PageHeader PageHeader = null;
		private DataDynamics.ActiveReports.Shape Shape = null;
		private DataDynamics.ActiveReports.Picture Picture = null;
		private DataDynamics.ActiveReports.Label Label = null;
		private DataDynamics.ActiveReports.Label Label1 = null;
		private DataDynamics.ActiveReports.Label Label2 = null;
		private DataDynamics.ActiveReports.Label Label3 = null;
		private DataDynamics.ActiveReports.Label Label4 = null;
		private DataDynamics.ActiveReports.Label Label5 = null;
		private DataDynamics.ActiveReports.Label Label6 = null;
		private DataDynamics.ActiveReports.Line Line = null;
		private DataDynamics.ActiveReports.Line Line1 = null;
		private DataDynamics.ActiveReports.Line Line2 = null;
		private DataDynamics.ActiveReports.Line Line3 = null;
		private DataDynamics.ActiveReports.Line Line4 = null;
		private DataDynamics.ActiveReports.Label Label11 = null;
		private DataDynamics.ActiveReports.Label Label12 = null;
		private DataDynamics.ActiveReports.Label Label13 = null;
		private DataDynamics.ActiveReports.Label Label14 = null;
		private DataDynamics.ActiveReports.Label Label15 = null;
		private DataDynamics.ActiveReports.Shape Shape3 = null;
		private DataDynamics.ActiveReports.Label lblJobNumber = null;
		private DataDynamics.ActiveReports.Label lblProject = null;
		private DataDynamics.ActiveReports.Label lblRevision = null;
		private DataDynamics.ActiveReports.Label lblLocation = null;
		private DataDynamics.ActiveReports.Label lblcustomer = null;
		private DataDynamics.ActiveReports.Line Line8 = null;
		private DataDynamics.ActiveReports.Line Line9 = null;
		private DataDynamics.ActiveReports.Line Line10 = null;
		private DataDynamics.ActiveReports.Detail Detail = null;
		private DataDynamics.ActiveReports.SubReport subGeneral = null;
		private DataDynamics.ActiveReports.SubReport subEngr = null;
		private DataDynamics.ActiveReports.SubReport subExpenses = null;
		private DataDynamics.ActiveReports.Label Label7 = null;
		private DataDynamics.ActiveReports.Label Label8 = null;
		private DataDynamics.ActiveReports.Line Line5 = null;
		private DataDynamics.ActiveReports.Line Line6 = null;
		private DataDynamics.ActiveReports.TextBox txtEngrLoadedDollars = null;
		private DataDynamics.ActiveReports.TextBox txtEngrLoadedRate = null;
		private DataDynamics.ActiveReports.TextBox txtEngrMHrs = null;
		private DataDynamics.ActiveReports.TextBox txtEngrPerOfHrs = null;
		private DataDynamics.ActiveReports.Label Label9 = null;
		private DataDynamics.ActiveReports.Label Label10 = null;
		private DataDynamics.ActiveReports.TextBox txtTotalLoadedDollars = null;
		private DataDynamics.ActiveReports.TextBox txtTotalLoadedRate = null;
		private DataDynamics.ActiveReports.TextBox txtTotalMHrs = null;
		private DataDynamics.ActiveReports.TextBox TextBox3 = null;
		private DataDynamics.ActiveReports.Line Line7 = null;
		private DataDynamics.ActiveReports.Shape Shape1 = null;
		private DataDynamics.ActiveReports.Shape Shape2 = null;
		private DataDynamics.ActiveReports.Label Label16 = null;
		private DataDynamics.ActiveReports.Label Label17 = null;
		private DataDynamics.ActiveReports.TextBox txtContingencyPerc = null;
		private DataDynamics.ActiveReports.TextBox txtContengency = null;
		private DataDynamics.ActiveReports.TextBox txtTotalDollars = null;
		private DataDynamics.ActiveReports.Line Line11 = null;
		private DataDynamics.ActiveReports.Line Line12 = null;
		private DataDynamics.ActiveReports.Line Line16 = null;
		private DataDynamics.ActiveReports.Label Label30 = null;
		private DataDynamics.ActiveReports.PageFooter PageFooter = null;
		private DataDynamics.ActiveReports.Label Label18 = null;
		private DataDynamics.ActiveReports.Label Label19 = null;
		private DataDynamics.ActiveReports.Label Label20 = null;
		private DataDynamics.ActiveReports.Label Label21 = null;
		private DataDynamics.ActiveReports.Label Label22 = null;
		private DataDynamics.ActiveReports.Label Label23 = null;
		private DataDynamics.ActiveReports.Label Label24 = null;
		private DataDynamics.ActiveReports.Label Label25 = null;
		private DataDynamics.ActiveReports.Label Label26 = null;
		private DataDynamics.ActiveReports.Label Label27 = null;
		private DataDynamics.ActiveReports.Line Line13 = null;
		private DataDynamics.ActiveReports.Line Line14 = null;
		private DataDynamics.ActiveReports.Line Line15 = null;
		private DataDynamics.ActiveReports.Line Line17 = null;
		private DataDynamics.ActiveReports.Line Line18 = null;
		private DataDynamics.ActiveReports.Line Line19 = null;
		private DataDynamics.ActiveReports.Line Line20 = null;
		private DataDynamics.ActiveReports.Line Line21 = null;
		private DataDynamics.ActiveReports.Line Line22 = null;
		private DataDynamics.ActiveReports.Line Line23 = null;
		private DataDynamics.ActiveReports.Label Label28 = null;
		private DataDynamics.ActiveReports.Label Label29 = null;
		public void InitializeReport()
		{
			this.LoadLayout(this.GetType(), "RSMPS.rprtBudgetSummary1.rpx");
			this.PageHeader = ((DataDynamics.ActiveReports.PageHeader)(this.Sections["PageHeader"]));
			this.Detail = ((DataDynamics.ActiveReports.Detail)(this.Sections["Detail"]));
			this.PageFooter = ((DataDynamics.ActiveReports.PageFooter)(this.Sections["PageFooter"]));
			this.Shape = ((DataDynamics.ActiveReports.Shape)(this.PageHeader.Controls[0]));
			this.Picture = ((DataDynamics.ActiveReports.Picture)(this.PageHeader.Controls[1]));
			this.Label = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[2]));
			this.Label1 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[3]));
			this.Label2 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[4]));
			this.Label3 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[5]));
			this.Label4 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[6]));
			this.Label5 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[7]));
			this.Label6 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[8]));
			this.Line = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[9]));
			this.Line1 = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[10]));
			this.Line2 = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[11]));
			this.Line3 = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[12]));
			this.Line4 = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[13]));
			this.Label11 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[14]));
			this.Label12 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[15]));
			this.Label13 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[16]));
			this.Label14 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[17]));
			this.Label15 = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[18]));
			this.Shape3 = ((DataDynamics.ActiveReports.Shape)(this.PageHeader.Controls[19]));
			this.lblJobNumber = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[20]));
			this.lblProject = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[21]));
			this.lblRevision = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[22]));
			this.lblLocation = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[23]));
			this.lblcustomer = ((DataDynamics.ActiveReports.Label)(this.PageHeader.Controls[24]));
			this.Line8 = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[25]));
			this.Line9 = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[26]));
			this.Line10 = ((DataDynamics.ActiveReports.Line)(this.PageHeader.Controls[27]));
			this.subGeneral = ((DataDynamics.ActiveReports.SubReport)(this.Detail.Controls[0]));
			this.subEngr = ((DataDynamics.ActiveReports.SubReport)(this.Detail.Controls[1]));
			this.subExpenses = ((DataDynamics.ActiveReports.SubReport)(this.Detail.Controls[2]));
			this.Label7 = ((DataDynamics.ActiveReports.Label)(this.Detail.Controls[3]));
			this.Label8 = ((DataDynamics.ActiveReports.Label)(this.Detail.Controls[4]));
			this.Line5 = ((DataDynamics.ActiveReports.Line)(this.Detail.Controls[5]));
			this.Line6 = ((DataDynamics.ActiveReports.Line)(this.Detail.Controls[6]));
			this.txtEngrLoadedDollars = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[7]));
			this.txtEngrLoadedRate = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[8]));
			this.txtEngrMHrs = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[9]));
			this.txtEngrPerOfHrs = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[10]));
			this.Label9 = ((DataDynamics.ActiveReports.Label)(this.Detail.Controls[11]));
			this.Label10 = ((DataDynamics.ActiveReports.Label)(this.Detail.Controls[12]));
			this.txtTotalLoadedDollars = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[13]));
			this.txtTotalLoadedRate = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[14]));
			this.txtTotalMHrs = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[15]));
			this.TextBox3 = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[16]));
			this.Line7 = ((DataDynamics.ActiveReports.Line)(this.Detail.Controls[17]));
			this.Shape1 = ((DataDynamics.ActiveReports.Shape)(this.Detail.Controls[18]));
			this.Shape2 = ((DataDynamics.ActiveReports.Shape)(this.Detail.Controls[19]));
			this.Label16 = ((DataDynamics.ActiveReports.Label)(this.Detail.Controls[20]));
			this.Label17 = ((DataDynamics.ActiveReports.Label)(this.Detail.Controls[21]));
			this.txtContingencyPerc = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[22]));
			this.txtContengency = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[23]));
			this.txtTotalDollars = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[24]));
			this.Line11 = ((DataDynamics.ActiveReports.Line)(this.Detail.Controls[25]));
			this.Line12 = ((DataDynamics.ActiveReports.Line)(this.Detail.Controls[26]));
			this.Line16 = ((DataDynamics.ActiveReports.Line)(this.Detail.Controls[27]));
			this.Label30 = ((DataDynamics.ActiveReports.Label)(this.Detail.Controls[28]));
			this.Label18 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[0]));
			this.Label19 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[1]));
			this.Label20 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[2]));
			this.Label21 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[3]));
			this.Label22 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[4]));
			this.Label23 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[5]));
			this.Label24 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[6]));
			this.Label25 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[7]));
			this.Label26 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[8]));
			this.Label27 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[9]));
			this.Line13 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[10]));
			this.Line14 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[11]));
			this.Line15 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[12]));
			this.Line17 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[13]));
			this.Line18 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[14]));
			this.Line19 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[15]));
			this.Line20 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[16]));
			this.Line21 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[17]));
			this.Line22 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[18]));
			this.Line23 = ((DataDynamics.ActiveReports.Line)(this.PageFooter.Controls[19]));
			this.Label28 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[20]));
			this.Label29 = ((DataDynamics.ActiveReports.Label)(this.PageFooter.Controls[21]));
			// Attach Report Events
			this.Detail.Format += new System.EventHandler(this.Detail_Format);
			this.PageStart += new System.EventHandler(this.rprtBudgetSummary1_PageStart);
		}

		#endregion
	}
}
