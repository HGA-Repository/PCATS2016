using System;
using DataDynamics.ActiveReports;
using DataDynamics.ActiveReports.Document;

using RevSol;

namespace RSMPS
{
	public class rprtBudgetDetailExps : ActiveReport
	{
        public event RevSol.PassMultiDataStrings OnReportTotaled;

        string msTitle = "";
        string msGroup = "";

        int miNumberItems;
        decimal mdMarkupDlrs;
        decimal mdTotalDlrs;

        public event HandleTotalValues OnTotalRun;

        public void SetTitle(string title, string group)
        {
            msTitle = title;
            msGroup = group;
        }

		public rprtBudgetDetailExps()
		{
			InitializeReport();
		}

		private void GroupFooter1_Format(object sender, System.EventArgs eArgs)
		{
            lblExpenseTitle.Text = "Total " + msTitle + " (" + msGroup + ") Expenses";

            if (OnTotalRun != null)
                OnTotalRun(Convert.ToDecimal(txtExpenseTotal.Value), 0, 0);
		}

		private void rprtBudgetDetailExps_ReportEnd(object sender, System.EventArgs eArgs)
		{
            if (OnReportTotaled != null)
            {
                string[] vals;

                vals = new string[3];

                vals[0] = miNumberItems.ToString();
                vals[1] = mdMarkupDlrs.ToString();
                vals[2] = mdTotalDlrs.ToString();

                OnReportTotaled(vals, 3);
            }
		}

		private void rprtBudgetDetailExps_ReportStart(object sender, System.EventArgs eArgs)
		{
            miNumberItems = 0;
            mdMarkupDlrs = 0;
            mdTotalDlrs = 0;
		}

		private void Detail_Format(object sender, System.EventArgs eArgs)
		{
            miNumberItems += Convert.ToInt32(txtNumItems.Value);
            mdMarkupDlrs += Convert.ToDecimal(txtMUDlrs.Value);
            mdTotalDlrs += Convert.ToDecimal(txtTotalDlrs.Value);
		}

		#region ActiveReports Designer generated code
		private DataDynamics.ActiveReports.PageHeader PageHeader = null;
		private DataDynamics.ActiveReports.GroupHeader GroupHeader1 = null;
		private DataDynamics.ActiveReports.Label Label = null;
		private DataDynamics.ActiveReports.Label Label1 = null;
		private DataDynamics.ActiveReports.Label Label2 = null;
		private DataDynamics.ActiveReports.Label Label3 = null;
		private DataDynamics.ActiveReports.Label Label4 = null;
		private DataDynamics.ActiveReports.Label Label5 = null;
		private DataDynamics.ActiveReports.Label Label6 = null;
		private DataDynamics.ActiveReports.Label Label7 = null;
		private DataDynamics.ActiveReports.Line Line2 = null;
		private DataDynamics.ActiveReports.Detail Detail = null;
		private DataDynamics.ActiveReports.TextBox TextBox = null;
		private DataDynamics.ActiveReports.TextBox TextBox1 = null;
		private DataDynamics.ActiveReports.TextBox TextBox2 = null;
		private DataDynamics.ActiveReports.TextBox TextBox3 = null;
		private DataDynamics.ActiveReports.TextBox TextBox4 = null;
		private DataDynamics.ActiveReports.TextBox txtNumItems = null;
		private DataDynamics.ActiveReports.TextBox txtMUDlrs = null;
		private DataDynamics.ActiveReports.TextBox txtTotalDlrs = null;
		private DataDynamics.ActiveReports.Line Line = null;
		private DataDynamics.ActiveReports.GroupFooter GroupFooter1 = null;
		private DataDynamics.ActiveReports.TextBox txtExpenseTotal = null;
		private DataDynamics.ActiveReports.Line Line1 = null;
		private DataDynamics.ActiveReports.Label lblExpenseTitle = null;
		private DataDynamics.ActiveReports.PageFooter PageFooter = null;
		public void InitializeReport()
		{
			this.LoadLayout(this.GetType(), "RSMPS.rprtBudgetDetailExps.rpx");
			this.PageHeader = ((DataDynamics.ActiveReports.PageHeader)(this.Sections["PageHeader"]));
			this.GroupHeader1 = ((DataDynamics.ActiveReports.GroupHeader)(this.Sections["GroupHeader1"]));
			this.Detail = ((DataDynamics.ActiveReports.Detail)(this.Sections["Detail"]));
			this.GroupFooter1 = ((DataDynamics.ActiveReports.GroupFooter)(this.Sections["GroupFooter1"]));
			this.PageFooter = ((DataDynamics.ActiveReports.PageFooter)(this.Sections["PageFooter"]));
			this.Label = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[0]));
			this.Label1 = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[1]));
			this.Label2 = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[2]));
			this.Label3 = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[3]));
			this.Label4 = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[4]));
			this.Label5 = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[5]));
			this.Label6 = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[6]));
			this.Label7 = ((DataDynamics.ActiveReports.Label)(this.GroupHeader1.Controls[7]));
			this.Line2 = ((DataDynamics.ActiveReports.Line)(this.GroupHeader1.Controls[8]));
			this.TextBox = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[0]));
			this.TextBox1 = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[1]));
			this.TextBox2 = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[2]));
			this.TextBox3 = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[3]));
			this.TextBox4 = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[4]));
			this.txtNumItems = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[5]));
			this.txtMUDlrs = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[6]));
			this.txtTotalDlrs = ((DataDynamics.ActiveReports.TextBox)(this.Detail.Controls[7]));
			this.Line = ((DataDynamics.ActiveReports.Line)(this.Detail.Controls[8]));
			this.txtExpenseTotal = ((DataDynamics.ActiveReports.TextBox)(this.GroupFooter1.Controls[0]));
			this.Line1 = ((DataDynamics.ActiveReports.Line)(this.GroupFooter1.Controls[1]));
			this.lblExpenseTitle = ((DataDynamics.ActiveReports.Label)(this.GroupFooter1.Controls[2]));
			// Attach Report Events
			this.GroupFooter1.Format += new System.EventHandler(this.GroupFooter1_Format);
			this.ReportEnd += new System.EventHandler(this.rprtBudgetDetailExps_ReportEnd);
			this.ReportStart += new System.EventHandler(this.rprtBudgetDetailExps_ReportStart);
			this.Detail.Format += new System.EventHandler(this.Detail_Format);
		}

		#endregion
	}
}
